<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dr. Sarah Johnson's Patient Portal - Transparent Scheduling</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .header p {
            text-align: center;
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.5rem;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .scheduling-interface {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .schedule-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .time-slot {
            background: #ecf0f1;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
        }

        .time-slot:hover {
            background: #d5dbdb;
            transform: scale(1.02);
        }

        .time-slot.booked {
            background: #e74c3c;
            color: white;
            cursor: not-allowed;
        }

        .time-slot.available {
            background: #27ae60;
            color: white;
        }

        .time-slot.optimized {
            background: #3498db;
            color: white;
        }

        .time-slot.passed {
            background: #95a5a6;
            color: white;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .time-slot.current {
            background: #f39c12;
            color: white;
            animation: pulse 2s infinite;
            border: 3px solid #e67e22;
        }

        .time-slot.patient-info {
            font-size: 0.7rem;
            margin-top: 5px;
            opacity: 0.9;
            font-weight: bold;
        }

        .time-slot-status {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 0.6rem;
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 3px;
            background: rgba(0, 0, 0, 0.3);
        }

        .patient-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .patient-item {
            background: #ffffff;
            border-left: 4px solid #3498db;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
        }

        .patient-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }

        .patient-item.high-priority {
            border-left-color: #e74c3c;
            background: linear-gradient(135deg, #fdf2f2, #ffffff);
        }

        .patient-item.medium-priority {
            border-left-color: #f39c12;
            background: linear-gradient(135deg, #fef9e7, #ffffff);
        }

        .patient-item.urgent-priority {
            border-left-color: #8e44ad;
            background: linear-gradient(135deg, #f4ecf7, #ffffff);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 2px 8px rgba(142, 68, 173, 0.3); }
            50% { box-shadow: 0 4px 20px rgba(142, 68, 173, 0.5); }
            100% { box-shadow: 0 2px 8px rgba(142, 68, 173, 0.3); }
        }

        .patient-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .patient-info {
            flex: 1;
        }

        .patient-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .patient-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        .patient-status-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 8px;
        }

        .patient-wait-days {
            background: #e74c3c;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            text-align: center;
            min-width: 60px;
        }

        .patient-wait-days.low {
            background: #27ae60;
        }

        .patient-wait-days.medium {
            background: #f39c12;
        }

        .patient-wait-days.high {
            background: #e74c3c;
        }

        .patient-status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
        }

        .status-scheduled {
            background: #3498db;
            color: white;
        }

        .status-waiting {
            background: #e67e22;
            color: white;
        }

        .status-in-progress {
            background: #9b59b6;
            color: white;
        }

        .status-completed {
            background: #27ae60;
            color: white;
        }

        .patient-actions {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }

        .patient-action-btn {
            background: #ecf0f1;
            border: none;
            padding: 5px 10px;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .patient-action-btn:hover {
            background: #3498db;
            color: white;
        }

        .queue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .queue-filters {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            background: #ecf0f1;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: #3498db;
            color: white;
        }

        .filter-btn:hover {
            background: #3498db;
            color: white;
        }

        .date-status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            text-transform: uppercase;
            margin-top: 5px;
        }

        .date-status-badge.today {
            background: #e74c3c;
            color: white;
            animation: pulse 2s infinite;
        }

        .date-status-badge.past {
            background: #95a5a6;
            color: white;
        }

        .date-status-badge.future {
            background: #27ae60;
            color: white;
        }

        .patient-item.high-priority {
            border-left-color: #e74c3c;
            background: #fdf2f2;
        }

        .patient-item.medium-priority {
            border-left-color: #f39c12;
            background: #fef9e7;
        }

        .feedback-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .feedback-form {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .feedback-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }

        .optimization-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-available { background: #27ae60; }
        .status-booked { background: #e74c3c; }
        .status-optimized { background: #3498db; }

        .wait-time-display {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(255, 118, 117, 0.3);
        }

        .wait-time-value {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .wait-days-display {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }

        .wait-days-value {
            font-size: 4rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .wait-days-label {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .wait-days-trend {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .wait-days-improvement {
            color: #2ecc71;
            font-weight: bold;
        }

        .wait-days-warning {
            color: #f39c12;
            font-weight: bold;
        }

        .analytics-chart {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-bar {
            background: #3498db;
            height: 20px;
            margin-bottom: 10px;
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .chart-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .analytics-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
        }

        .analytics-card h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 0.9rem;
        }

        .analytics-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3498db;
            margin-bottom: 5px;
        }

        .analytics-label {
            font-size: 0.8rem;
            color: #7f8c8d;
        }

        .schedule-insights {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }

        .schedule-insights h4 {
            margin: 0 0 10px 0;
            color: #28a745;
            font-size: 0.9rem;
        }

        .insight-item {
            background: white;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            font-size: 0.85rem;
            border-left: 3px solid #28a745;
        }

        .wait-time-chart {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .wait-time-chart h4 {
            margin: 0 0 15px 0;
            font-size: 1rem;
        }

        .wait-time-bar {
            background: rgba(255, 255, 255, 0.3);
            height: 25px;
            border-radius: 12px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .wait-time-fill {
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
            transition: width 0.8s ease;
            position: relative;
        }

        .wait-time-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            animation: shimmer 2s infinite;
        }

        .wait-time-label {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .wait-time-value {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            font-size: 0.8rem;
            font-weight: bold;
            color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        @media (max-width: 768px) {
            .dashboard,
            .scheduling-interface,
            .feedback-section {
                grid-template-columns: 1fr;
            }
            
            .schedule-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>🏥 Dr. Sarah Johnson's Patient Portal</h1>
            <p>Transparent scheduling • Clear wait times • Patient-first care</p>
            <div style="background: rgba(46, 204, 113, 0.1); border: 2px solid #27ae60; border-radius: 10px; padding: 15px; margin-top: 15px;">
                <h3 style="color: #27ae60; margin: 0 0 10px 0;">📋 Your Appointment Status</h3>
                <p style="margin: 0; color: #2c3e50;">See exactly when you'll see Dr. Sarah • Track your wait time • Know what to expect</p>
            </div>
        </div>

        <!-- Patient-Centric Dashboard -->
        <div class="dashboard">
            <div class="card">
                <h2>⏰ Your Wait Time Information</h2>
                <div style="background: linear-gradient(135deg, #3498db, #2980b9); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 3rem; font-weight: bold; margin-bottom: 10px;" id="patientWaitDays">4</div>
                    <div style="font-size: 1.2rem; margin-bottom: 5px;">Days Until Your Appointment</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">Based on current schedule and priority</div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #27ae60;">
                        <div style="font-weight: bold; color: #27ae60;">✅ Target Met</div>
                        <div style="font-size: 0.9rem; color: #7f8c8d;">Your wait time is within our 7-day target</div>
                    </div>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #3498db;">
                        <div style="font-weight: bold; color: #3498db;">📅 Next Available</div>
                        <div style="font-size: 0.9rem; color: #7f8c8d;">Dr. Sarah's next open slot</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>👩‍⚕️ Dr. Sarah's Current Status</h2>
                <div style="background: linear-gradient(135deg, #27ae60, #229954); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">🟢 AVAILABLE</div>
                    <div style="font-size: 1.1rem;">Dr. Sarah is currently seeing patients</div>
                    <div style="font-size: 0.9rem; opacity: 0.9; margin-top: 5px;">Last updated: <span id="lastUpdated">Just now</span></div>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
                    <h4 style="margin: 0 0 10px 0; color: #2c3e50;">📊 Today's Schedule Overview</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9rem;">
                        <div><strong>Patients Today:</strong> <span id="patientsToday">1</span></div>
                        <div><strong>Completed:</strong> <span id="completedTodayPatient">0</span></div>
                        <div><strong>In Progress:</strong> <span id="inProgressToday">1</span></div>
                        <div><strong>Waiting:</strong> <span id="waitingToday">0</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scheduling Interface -->
        <div class="scheduling-interface">
            <div class="card">
                <h2>📅 Schedule New Appointment</h2>
                <form id="appointmentForm">
                    <div class="form-group">
                        <label for="patientName">Patient Name</label>
                        <input type="text" id="patientName" required>
                    </div>
                    <div class="form-group">
                        <label for="patientType">Appointment Type</label>
                        <select id="patientType" required>
                            <option value="">Select Type</option>
                            <option value="consultation">Initial Consultation</option>
                            <option value="followup">Follow-up</option>
                            <option value="treatment">Treatment</option>
                            <option value="urgent">Urgent Care</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="priority">Priority Level</label>
                        <select id="priority" required>
                            <option value="low">Low Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="high">High Priority</option>
                            <option value="urgent">Urgent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="preferredDate">Preferred Date</label>
                        <input type="date" id="preferredDate" required>
                    </div>
                    <div class="form-group">
                        <label for="notes">Special Notes</label>
                        <textarea id="notes" rows="3" placeholder="Any special requirements or notes..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">Schedule Appointment</button>
                </form>
            </div>

            <div class="card">
                <h2>🔧 Optimization Controls</h2>
                <div class="optimization-controls">
                    <button class="btn" onclick="reduceWaitDays()">📅 Reduce Wait Days</button>
                    <button class="btn btn-warning" onclick="optimizeSchedule()">🚀 Optimize Schedule</button>
                    <button class="btn btn-success" onclick="balanceWorkload()">⚖️ Balance Workload</button>
                    <button class="btn" onclick="generateReport()">📈 Generate Report</button>
                </div>
                
                <h3>Today's Schedule Overview</h3>
                <div class="schedule-grid" id="scheduleGrid">
                    <!-- Schedule slots will be populated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Transparent Patient Queue -->
        <div class="dashboard">
            <div class="card">
                <div class="queue-header">
                    <h2>👥 Current Patient Queue</h2>
                    <div style="background: rgba(52, 152, 219, 0.1); padding: 10px; border-radius: 8px; border-left: 4px solid #3498db;">
                        <div style="font-size: 0.9rem; color: #2c3e50;">
                            <strong>Transparency Promise:</strong> See exactly where you are in line and when you'll be seen
                        </div>
                    </div>
                </div>
                <div class="patient-list" id="patientList">
                    <!-- Patient items will be populated by JavaScript -->
                </div>
            </div>

            <div class="card">
                <h2>📈 Dr. Sarah Johnson's Schedule Analytics</h2>
                
                <!-- Key Performance Indicators -->
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h4>📅 Today's Schedule</h4>
                        <div class="analytics-value" id="todayAppointments">1</div>
                        <div class="analytics-label">Appointments Today</div>
                    </div>
                    <div class="analytics-card">
                        <h4>⏱️ Avg Wait Days</h4>
                        <div class="analytics-value" id="avgWaitDaysAnalytics">4</div>
                        <div class="analytics-label">Days Until Visit</div>
                    </div>
                    <div class="analytics-card">
                        <h4>🎯 Utilization</h4>
                        <div class="analytics-value" id="utilizationAnalytics">78%</div>
                        <div class="analytics-label">Schedule Efficiency</div>
                    </div>
                    <div class="analytics-card">
                        <h4>⚡ Next Available</h4>
                        <div class="analytics-value" id="nextAvailable">1</div>
                        <div class="analytics-label">Days</div>
                    </div>
                </div>

                <!-- Daily Utilization Chart -->
                <div class="analytics-chart">
                    <h4>📊 Daily Utilization by Hour</h4>
                    <div class="chart-bar" style="width: 85%;">8:00 AM - 85%</div>
                    <div class="chart-bar" style="width: 95%;">9:00 AM - 95%</div>
                    <div class="chart-bar" style="width: 78%;">10:00 AM - 78%</div>
                    <div class="chart-bar" style="width: 92%;">11:00 AM - 92%</div>
                    <div class="chart-bar" style="width: 88%;">1:00 PM - 88%</div>
                    <div class="chart-bar" style="width: 76%;">2:00 PM - 76%</div>
                    <div class="chart-bar" style="width: 82%;">3:00 PM - 82%</div>
                    <div class="chart-bar" style="width: 70%;">4:00 PM - 70%</div>
                </div>

                <!-- Wait Days Distribution Chart -->
                <div class="wait-time-chart">
                    <h4>📅 Patient Wait Days Distribution</h4>
                    <div class="wait-time-bar">
                        <div class="wait-time-fill" style="width: 15%;"></div>
                        <div class="wait-time-label">≤3 Days</div>
                        <div class="wait-time-value">15%</div>
                    </div>
                    <div class="wait-time-bar">
                        <div class="wait-time-fill" style="width: 35%;"></div>
                        <div class="wait-time-label">4-7 Days</div>
                        <div class="wait-time-value">35%</div>
                    </div>
                    <div class="wait-time-bar">
                        <div class="wait-time-fill" style="width: 30%;"></div>
                        <div class="wait-time-label">8-14 Days</div>
                        <div class="wait-time-value">30%</div>
                    </div>
                    <div class="wait-time-bar">
                        <div class="wait-time-fill" style="width: 20%;"></div>
                        <div class="wait-time-label">>14 Days</div>
                        <div class="wait-time-value">20%</div>
                    </div>
                </div>

                <!-- Schedule Insights -->
                <div class="schedule-insights">
                    <h4>💡 Schedule Optimization Insights</h4>
                    <div class="insight-item" id="insight1">✅ Target achieved: 15% of patients seen within 3 days</div>
                    <div class="insight-item" id="insight2">⚠️ 20% of patients wait >14 days - needs attention</div>
                    <div class="insight-item" id="insight3">📈 Peak utilization at 9:00 AM (95%) - consider adding slots</div>
                    <div class="insight-item" id="insight4">🕐 Low utilization at 4:00 PM (70%) - opportunity for optimization</div>
                </div>

                <!-- Patient Load Summary -->
                <div style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #3498db;">
                    <h4 style="margin: 0 0 10px 0; color: #2c3e50;">📋 Patient Load Summary</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 0.9rem;">
                        <div><strong>Active Patients:</strong> <span id="activePatients">6</span></div>
                        <div><strong>Completed Today:</strong> <span id="completedToday">1</span></div>
                        <div><strong>Scheduled:</strong> <span id="scheduledCount">3</span></div>
                        <div><strong>Waiting:</strong> <span id="waitingCount">2</span></div>
                        <div><strong>Urgent Cases:</strong> <span id="urgentCount">1</span></div>
                        <div><strong>Avg Wait Days:</strong> <span id="avgWaitDaysSummary">4</span> days</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Feedback System -->
        <div class="feedback-section">
            <div class="feedback-form">
                <h2>💬 Patient Feedback</h2>
                <form id="feedbackForm">
                    <div class="form-group">
                        <label for="feedbackType">Feedback Type</label>
                        <select id="feedbackType" required>
                            <option value="">Select Type</option>
                            <option value="wait-time">Wait Time</option>
                            <option value="staff">Staff Experience</option>
                            <option value="scheduling">Scheduling Process</option>
                            <option value="facility">Facility</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="feedbackRating">Rating (1-5)</label>
                        <select id="feedbackRating" required>
                            <option value="">Select Rating</option>
                            <option value="1">1 - Poor</option>
                            <option value="2">2 - Fair</option>
                            <option value="3">3 - Good</option>
                            <option value="4">4 - Very Good</option>
                            <option value="5">5 - Excellent</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="feedbackComment">Comments</label>
                        <textarea id="feedbackComment" rows="4" placeholder="Please share your experience..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-success">Submit Feedback</button>
                </form>
            </div>

            <div class="feedback-form">
                <h2>📋 Recent Feedback</h2>
                <div id="recentFeedback">
                    <!-- Feedback items will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Prevent Firebase initialization
        window.firebase = undefined;
        console.log('Firebase blocked from initialization');
        
        // Global state management
        let appointments = [];
        let feedback = [];
        let schedule = {};
        let doctor = 'Dr. Sarah Johnson'; // Single doctor

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeSchedule();
            loadSampleData();
            updateDashboard();
            startRealTimeUpdates();
        });

        // Initialize schedule grid with real-time status
        function initializeSchedule() {
            const grid = document.getElementById('scheduleGrid');
            const timeSlots = [
                '8:00', '8:30', '9:00', '9:30', '10:00', '10:30', '11:00', '11:30',
                '1:00', '1:30', '2:00', '2:30', '3:00', '3:30', '4:00', '4:30'
            ];

            grid.innerHTML = '';
            timeSlots.forEach(slot => {
                const slotElement = document.createElement('div');
                slotElement.className = 'time-slot';
                slotElement.textContent = slot;
                slotElement.onclick = () => selectTimeSlot(slot, slotElement);
                grid.appendChild(slotElement);
            });
            
            // Update schedule grid with current status
            updateScheduleGrid();
        }

        // Update schedule grid with real-time status
        function updateScheduleGrid() {
            const grid = document.getElementById('scheduleGrid');
            const slots = grid.querySelectorAll('.time-slot');
            const now = new Date();
            const currentHour = now.getHours();
            const currentMinute = now.getMinutes();
            
            slots.forEach(slot => {
                const timeText = slot.textContent.split('\n')[0]; // Get just the time part
                const [hour, minute] = timeText.split(':').map(Number);
                
                // Convert to 24-hour format for comparison
                const slotHour = hour === 12 ? 12 : hour;
                const slotTime = slotHour * 60 + minute;
                const currentTime = currentHour * 60 + currentMinute;
                
                // Reset classes
                slot.className = 'time-slot';
                slot.innerHTML = timeText;
                
                // Find if there's an appointment for this time slot today
                const today = new Date();
                const appointmentForSlot = appointments.find(apt => {
                    const aptDate = new Date(apt.scheduledDate);
                    return aptDate.toDateString() === today.toDateString() && apt.time === timeText;
                });
                
                if (appointmentForSlot) {
                    // Slot is booked
                    slot.classList.add('booked');
                    slot.innerHTML = `
                        <div class="time-slot-status">BOOKED</div>
                        ${timeText}
                        <div class="time-slot.patient-info">${appointmentForSlot.name}</div>
                    `;
                    
                    // Check if it's currently happening
                    if (slotTime === currentTime || (slotTime < currentTime && slotTime + 30 > currentTime)) {
                        slot.classList.remove('booked');
                        slot.classList.add('current');
                        slot.innerHTML = `
                            <div class="time-slot-status">NOW</div>
                            ${timeText}
                            <div class="time-slot.patient-info">${appointmentForSlot.name}</div>
                        `;
                    }
                } else if (slotTime < currentTime) {
                    // Time has passed
                    slot.classList.add('passed');
                    slot.innerHTML = `
                        <div class="time-slot-status">PASSED</div>
                        ${timeText}
                    `;
                } else if (slotTime === currentTime) {
                    // Current time slot
                    slot.classList.add('current');
                    slot.innerHTML = `
                        <div class="time-slot-status">NOW</div>
                        ${timeText}
                    `;
                } else {
                    // Available slot
                    slot.classList.add('available');
                    slot.innerHTML = `
                        <div class="time-slot-status">FREE</div>
                        ${timeText}
                    `;
                }
                
                // Add click handler
                slot.onclick = () => selectTimeSlot(timeText, slot);
            });
        }

        // Load sample data
        function loadSampleData() {
            // Sample appointments with wait days calculation
            const today = new Date();
            appointments = [
                { 
                    id: 1, 
                    name: 'John Doe', 
                    type: 'consultation', 
                    priority: 'high', 
                    time: '9:00', 
                    provider: doctor, 
                    status: 'completed',
                    scheduledDate: new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000), // 2 days ago
                    requestDate: new Date(today.getTime() - 7 * 24 * 60 * 60 * 1000), // 7 days ago
                    notes: 'Initial consultation for chest pain'
                },
                { 
                    id: 2, 
                    name: 'Jane Miller', 
                    type: 'followup', 
                    priority: 'medium', 
                    time: '10:30', 
                    provider: doctor, 
                    status: 'in-progress',
                    scheduledDate: today, // Today
                    requestDate: new Date(today.getTime() - 5 * 24 * 60 * 60 * 1000), // 5 days ago
                    notes: 'Follow-up for diabetes management'
                },
                { 
                    id: 3, 
                    name: 'Bob Wilson', 
                    type: 'treatment', 
                    priority: 'low', 
                    time: '2:00', 
                    provider: doctor, 
                    status: 'scheduled',
                    scheduledDate: new Date(today.getTime() + 1 * 24 * 60 * 60 * 1000), // Tomorrow
                    requestDate: new Date(today.getTime() - 3 * 24 * 60 * 60 * 1000), // 3 days ago
                    notes: 'Routine chemotherapy session'
                },
                { 
                    id: 4, 
                    name: 'Alice Taylor', 
                    type: 'urgent', 
                    priority: 'urgent', 
                    time: '11:00', 
                    provider: doctor, 
                    status: 'waiting',
                    scheduledDate: new Date(today.getTime() + 2 * 24 * 60 * 60 * 1000), // Day after tomorrow
                    requestDate: new Date(today.getTime() - 1 * 24 * 60 * 60 * 1000), // 1 day ago
                    notes: 'URGENT: Severe symptoms requiring immediate attention'
                },
                { 
                    id: 5, 
                    name: 'Michael Davis', 
                    type: 'consultation', 
                    priority: 'medium', 
                    time: '3:30', 
                    provider: doctor, 
                    status: 'scheduled',
                    scheduledDate: new Date(today.getTime() + 3 * 24 * 60 * 60 * 1000), // 3 days from now
                    requestDate: new Date(today.getTime() - 2 * 24 * 60 * 60 * 1000), // 2 days ago
                    notes: 'Routine check-up and blood work review'
                },
                { 
                    id: 6, 
                    name: 'Lisa Garcia', 
                    type: 'followup', 
                    priority: 'high', 
                    time: '4:00', 
                    provider: doctor, 
                    status: 'waiting',
                    scheduledDate: new Date(today.getTime() + 5 * 24 * 60 * 60 * 1000), // 5 days from now
                    requestDate: new Date(today.getTime() - 4 * 24 * 60 * 60 * 1000), // 4 days ago
                    notes: 'High priority follow-up for test results'
                },
                { 
                    id: 7, 
                    name: 'Sarah Johnson', 
                    type: 'consultation', 
                    priority: 'high', 
                    time: '1:00', 
                    provider: doctor, 
                    status: 'scheduled',
                    scheduledDate: new Date(today.getTime() + 7 * 24 * 60 * 60 * 1000), // 7 days from now
                    requestDate: new Date(today.getTime() - 6 * 24 * 60 * 60 * 1000), // 6 days ago
                    notes: 'Follow-up for recent test results'
                }
            ];

            // Sample feedback
            feedback = [
                { type: 'wait-time', rating: 4, comment: 'Wait time was reasonable today', timestamp: new Date() },
                { type: 'staff', rating: 5, comment: 'Staff was very helpful and professional', timestamp: new Date() },
                { type: 'scheduling', rating: 3, comment: 'Scheduling process could be improved', timestamp: new Date() }
            ];

            updatePatientList();
            updateRecentFeedback();
        }

        // Calculate wait days for an appointment
        function calculateWaitDays(appointment) {
            const today = new Date();
            const scheduledDate = new Date(appointment.scheduledDate);
            const requestDate = new Date(appointment.requestDate);
            
            if (appointment.status === 'completed') {
                return Math.ceil((scheduledDate - requestDate) / (1000 * 60 * 60 * 24));
            } else {
                return Math.ceil((scheduledDate - today) / (1000 * 60 * 60 * 24));
            }
        }

        // Get wait days category for styling
        function getWaitDaysCategory(waitDays) {
            if (waitDays <= 3) return 'low';
            if (waitDays <= 7) return 'medium';
            return 'high';
        }

        // Global filter state
        let currentFilter = 'all';

        // Update patient list display with enhanced information
        function updatePatientList() {
            const list = document.getElementById('patientList');
            list.innerHTML = '';

            // Filter appointments based on current filter
            let filteredAppointments = appointments;
            if (currentFilter !== 'all') {
                filteredAppointments = appointments.filter(appointment => {
                    if (currentFilter === 'today') {
                        const today = new Date();
                        const appointmentDate = new Date(appointment.scheduledDate);
                        today.setHours(0, 0, 0, 0);
                        appointmentDate.setHours(0, 0, 0, 0);
                        return appointmentDate.getTime() === today.getTime();
                    }
                    if (currentFilter === 'urgent') return appointment.priority === 'urgent';
                    if (currentFilter === 'waiting') return appointment.status === 'waiting';
                    if (currentFilter === 'scheduled') return appointment.status === 'scheduled';
                    return true;
                });
            }

            // Sort by appointment date (chronological order)
            filteredAppointments.sort((a, b) => {
                const dateA = new Date(a.scheduledDate);
                const dateB = new Date(b.scheduledDate);
                return dateA - dateB; // Chronological order (earliest first)
            });

            filteredAppointments.forEach(appointment => {
                const waitDays = calculateWaitDays(appointment);
                const waitCategory = getWaitDaysCategory(waitDays);
                const scheduledDate = new Date(appointment.scheduledDate);
                const requestDate = new Date(appointment.requestDate);
                
                const item = document.createElement('div');
                item.className = `patient-item ${appointment.priority}-priority`;
                // Determine if appointment is today, past, or future
                const today = new Date();
                const appointmentDate = new Date(scheduledDate);
                appointmentDate.setHours(0, 0, 0, 0);
                today.setHours(0, 0, 0, 0);
                
                let dateStatus = '';
                let dateClass = '';
                if (appointmentDate.getTime() === today.getTime()) {
                    dateStatus = 'TODAY';
                    dateClass = 'today';
                } else if (appointmentDate < today) {
                    dateStatus = 'PAST';
                    dateClass = 'past';
                } else {
                    dateStatus = 'FUTURE';
                    dateClass = 'future';
                }

                item.innerHTML = `
                    <div class="patient-header">
                        <div class="patient-info">
                            <div class="patient-name">${appointment.name}</div>
                            <div class="patient-details">
                                <div><strong>Appointment Date:</strong> ${scheduledDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                                <div><strong>Time:</strong> ${appointment.time}</div>
                                <div><strong>Type:</strong> ${appointment.type}</div>
                                <div><strong>Priority:</strong> ${appointment.priority}</div>
                            </div>
                        </div>
                        <div class="patient-status-section">
                            <span class="patient-status-badge status-${appointment.status}">${appointment.status}</span>
                            <span class="patient-wait-days ${waitCategory}">${waitDays} days</span>
                            <span class="date-status-badge ${dateClass}">${dateStatus}</span>
                        </div>
                    </div>
                    <div class="patient-actions">
                        <button class="patient-action-btn" onclick="updatePatientStatus(${appointment.id}, 'in-progress')">Start</button>
                        <button class="patient-action-btn" onclick="updatePatientStatus(${appointment.id}, 'completed')">Complete</button>
                        <button class="patient-action-btn" onclick="reschedulePatient(${appointment.id})">Reschedule</button>
                        <button class="patient-action-btn" onclick="viewPatientDetails(${appointment.id})">Details</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        // Filter patients function
        function filterPatients(filter) {
            currentFilter = filter;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updatePatientList();
        }

        // Update patient status
        function updatePatientStatus(patientId, newStatus) {
            const appointment = appointments.find(apt => apt.id === patientId);
            if (appointment) {
                appointment.status = newStatus;
                updatePatientList();
                updateDashboard();
                alert(`Patient ${appointment.name} status updated to ${newStatus}`);
            }
        }

        // Reschedule patient
        function reschedulePatient(patientId) {
            const appointment = appointments.find(apt => apt.id === patientId);
            if (appointment) {
                const newDate = prompt(`Reschedule ${appointment.name} to (YYYY-MM-DD):`, 
                    new Date(appointment.scheduledDate).toISOString().split('T')[0]);
                if (newDate) {
                    appointment.scheduledDate = new Date(newDate);
                    updatePatientList();
                    updateDashboard();
                    alert(`${appointment.name} rescheduled to ${newDate}`);
                }
            }
        }

        // View patient details
        function viewPatientDetails(patientId) {
            const appointment = appointments.find(apt => apt.id === patientId);
            if (appointment) {
                const waitDays = calculateWaitDays(appointment);
                const scheduledDate = new Date(appointment.scheduledDate);
                const requestDate = new Date(appointment.requestDate);
                
                // Determine date status
                const today = new Date();
                const appointmentDate = new Date(scheduledDate);
                today.setHours(0, 0, 0, 0);
                appointmentDate.setHours(0, 0, 0, 0);
                
                let dateStatus = '';
                if (appointmentDate.getTime() === today.getTime()) {
                    dateStatus = 'TODAY';
                } else if (appointmentDate < today) {
                    dateStatus = 'PAST APPOINTMENT';
                } else {
                    dateStatus = 'FUTURE APPOINTMENT';
                }
                
                const details = `
Patient Details:
Name: ${appointment.name}
Type: ${appointment.type}
Priority: ${appointment.priority}
Status: ${appointment.status}

APPOINTMENT SCHEDULE:
Date: ${scheduledDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
Time: ${appointment.time}
Status: ${dateStatus}
Wait Days: ${waitDays}

REQUEST INFO:
Requested: ${requestDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
Notes: ${appointment.notes || 'None'}
                `;
                alert(details);
            }
        }

        // Update recent feedback display
        function updateRecentFeedback() {
            const container = document.getElementById('recentFeedback');
            container.innerHTML = '';

            feedback.slice(-5).forEach(item => {
                const feedbackElement = document.createElement('div');
                feedbackElement.className = 'feedback-item';
                feedbackElement.innerHTML = `
                    <strong>${item.type.replace('-', ' ').toUpperCase()}</strong> - ${item.rating}/5 stars<br>
                    <em>${item.comment}</em><br>
                    <small>${item.timestamp.toLocaleDateString()}</small>
                `;
                container.appendChild(feedbackElement);
            });
        }

        // Handle appointment form submission
        document.getElementById('appointmentForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                id: appointments.length + 1,
                name: document.getElementById('patientName').value,
                type: document.getElementById('patientType').value,
                priority: document.getElementById('priority').value,
                date: document.getElementById('preferredDate').value,
                notes: document.getElementById('notes').value,
                status: 'scheduled',
                provider: doctor,
                requestDate: new Date(),
                scheduledDate: new Date(document.getElementById('preferredDate').value)
            };

            appointments.push(formData);
            updatePatientList();
            updateDashboard();
            
            // Clear form
            this.reset();
            
            // Show success message
            alert('Appointment scheduled successfully!');
        });

        // Handle feedback form submission
        document.getElementById('feedbackForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const feedbackData = {
                type: document.getElementById('feedbackType').value,
                rating: parseInt(document.getElementById('feedbackRating').value),
                comment: document.getElementById('feedbackComment').value,
                timestamp: new Date()
            };

            feedback.push(feedbackData);
            updateRecentFeedback();
            updateDashboard();
            
            // Clear form
            this.reset();
            
            // Show success message
            alert('Feedback submitted successfully! Thank you for your input.');
        });

        // Calculate average wait days
        function calculateAverageWaitDays() {
            const activeAppointments = appointments.filter(apt => apt.status !== 'completed');
            if (activeAppointments.length === 0) return 0;
            
            const totalWaitDays = activeAppointments.reduce((sum, apt) => {
                return sum + calculateWaitDays(apt);
            }, 0);
            
            return Math.round(totalWaitDays / activeAppointments.length);
        }

        // Main optimization function - Reduce Wait Days
        function reduceWaitDays() {
            // Reduce average wait days by optimizing schedules
            const currentWaitDays = document.getElementById('avgWaitDays');
            const currentWaitDaysDisplay = document.getElementById('currentWaitDays');
            const trendElement = document.getElementById('waitDaysTrend');
            
            let currentDays = parseInt(currentWaitDays.textContent);
            let displayDays = parseInt(currentWaitDaysDisplay.textContent);
            
            // Reduce by 2-3 days through optimization
            const reduction = Math.floor(Math.random() * 2) + 2;
            const newDays = Math.max(3, currentDays - reduction);
            const newDisplayDays = Math.max(3, displayDays - reduction);
            
            currentWaitDays.textContent = newDays;
            currentWaitDaysDisplay.textContent = newDisplayDays;
            
            // Update trend
            trendElement.innerHTML = `<span class="wait-days-improvement">↓ ${reduction} days improvement through optimization</span>`;
            
            // Update patient schedules to reflect reduced wait times
            appointments.forEach(appointment => {
                if (appointment.status === 'scheduled' || appointment.status === 'waiting') {
                    const currentWait = calculateWaitDays(appointment);
                    if (currentWait > 7) {
                        // Reduce wait time by moving appointment closer
                        const reductionDays = Math.min(reduction, currentWait - 3);
                        appointment.scheduledDate = new Date(appointment.scheduledDate.getTime() - reductionDays * 24 * 60 * 60 * 1000);
                    }
                }
            });
            
            updatePatientList();
            alert(`Wait days reduced by ${reduction} days! Average wait time now ${newDays} days.`);
        }

        // Optimization functions
        function optimizeSchedule() {
            // Simulate optimization algorithm focused on wait days
            const utilization = document.getElementById('providerUtilization');
            const satisfaction = document.getElementById('patientSatisfaction');
            
            // Increase utilization by 10%
            let currentUtil = parseInt(utilization.textContent);
            utilization.textContent = Math.min(100, currentUtil + 10);
            
            // Improve satisfaction
            let currentSat = parseFloat(satisfaction.textContent);
            satisfaction.textContent = (currentSat + 0.3).toFixed(1);
            
            // Update schedule grid to show optimized slots
            const slots = document.querySelectorAll('.time-slot');
            slots.forEach(slot => {
                if (slot.classList.contains('available')) {
                    slot.classList.remove('available');
                    slot.classList.add('optimized');
                }
            });
            
            alert('Schedule optimized! Utilization improved, focus on reducing wait days.');
        }

        function balanceWorkload() {
            // For single doctor, optimize schedule distribution throughout the day
            const scheduledAppointments = appointments.filter(apt => apt.status === 'scheduled');
            
            // Redistribute appointments more evenly throughout the day
            const timeSlots = ['8:00', '8:30', '9:00', '9:30', '10:00', '10:30', '11:00', '11:30', '1:00', '1:30', '2:00', '2:30', '3:00', '3:30', '4:00', '4:30'];
            
            scheduledAppointments.forEach((appointment, index) => {
                appointment.time = timeSlots[index % timeSlots.length];
            });
            
            updatePatientList();
            alert('Dr. Sarah Johnson\'s schedule optimized for better workload distribution throughout the day.');
        }

        // Legacy function removed - now using reduceWaitDays() instead

        function generateReport() {
            const report = `
DR. SARAH JOHNSON'S SCHEDULING REPORT
Generated: ${new Date().toLocaleString()}

KEY METRICS:
- Average Wait Days: ${document.getElementById('avgWaitDays').textContent} days
- Dr. Sarah's Utilization: ${document.getElementById('providerUtilization').textContent}%
- Patient Satisfaction: ${document.getElementById('patientSatisfaction').textContent}/5
- Total Appointments Today: ${document.getElementById('appointmentsToday').textContent}

PATIENT LOAD ANALYSIS:
- Active Patients: ${appointments.filter(apt => apt.status !== 'completed').length}
- Completed Today: ${appointments.filter(apt => apt.status === 'completed').length}
- Scheduled: ${appointments.filter(apt => apt.status === 'scheduled').length}
- Waiting: ${appointments.filter(apt => apt.status === 'waiting').length}

OPTIMIZATION RECOMMENDATIONS:
1. Focus on reducing wait days to target of <7 days
2. Optimize daily schedule distribution for Dr. Sarah
3. Implement priority-based scheduling for urgent cases
4. Use buffer time between appointments for better patient flow
5. Monitor real-time wait days for immediate adjustments

FEEDBACK SUMMARY:
- Recent feedback items: ${feedback.length}
- Average rating: ${(feedback.reduce((sum, f) => sum + f.rating, 0) / feedback.length).toFixed(1)}/5
            `;
            
            alert(report);
        }

        function selectTimeSlot(time, element) {
            if (element.classList.contains('booked')) {
                alert('This time slot is already booked.');
                return;
            }
            
            // Toggle selection
            element.classList.toggle('optimized');
            alert(`Time slot ${time} selected for optimization.`);
        }

        function updateDashboard() {
            // Update patient-centric dashboard
            updatePatientCentricDashboard();
            
            // Update analytics dashboard
            updateAnalyticsDashboard();
            
            // Update schedule grid
            updateScheduleGrid();
        }

        // Update patient-centric dashboard
        function updatePatientCentricDashboard() {
            const avgWaitDays = calculateAverageWaitDays();
            const today = new Date();
            
            // Update patient wait days display
            document.getElementById('patientWaitDays').textContent = avgWaitDays;
            
            // Update Dr. Sarah's status
            const inProgressToday = appointments.filter(apt => {
                const aptDate = new Date(apt.scheduledDate);
                return aptDate.toDateString() === today.toDateString() && apt.status === 'in-progress';
            }).length;
            
            const statusElement = document.getElementById('lastUpdated');
            statusElement.textContent = new Date().toLocaleTimeString();
            
            // Update today's schedule overview
            const todayAppointments = appointments.filter(apt => {
                const aptDate = new Date(apt.scheduledDate);
                return aptDate.toDateString() === today.toDateString();
            });
            
            document.getElementById('patientsToday').textContent = todayAppointments.length;
            document.getElementById('completedTodayPatient').textContent = todayAppointments.filter(apt => apt.status === 'completed').length;
            document.getElementById('inProgressToday').textContent = todayAppointments.filter(apt => apt.status === 'in-progress').length;
            document.getElementById('waitingToday').textContent = todayAppointments.filter(apt => apt.status === 'waiting').length;
        }

        // Update analytics dashboard with real-time data
        function updateAnalyticsDashboard() {
            const today = new Date();
            const todayAppointments = appointments.filter(apt => {
                const aptDate = new Date(apt.scheduledDate);
                return aptDate.toDateString() === today.toDateString();
            }).length;
            
            const avgWaitDays = calculateAverageWaitDays();
            const activePatients = appointments.filter(apt => apt.status !== 'completed').length;
            const completedToday = appointments.filter(apt => apt.status === 'completed').length;
            const scheduledCount = appointments.filter(apt => apt.status === 'scheduled').length;
            const waitingCount = appointments.filter(apt => apt.status === 'waiting').length;
            const urgentCount = appointments.filter(apt => apt.priority === 'urgent').length;
            
            // Calculate next available slot
            const futureAppointments = appointments.filter(apt => {
                const aptDate = new Date(apt.scheduledDate);
                return aptDate > today && apt.status === 'scheduled';
            });
            const nextAvailable = futureAppointments.length > 0 ? 
                Math.min(...futureAppointments.map(apt => calculateWaitDays(apt))) : 0;
            
            // Update analytics cards
            document.getElementById('todayAppointments').textContent = todayAppointments;
            document.getElementById('avgWaitDaysAnalytics').textContent = avgWaitDays;
            document.getElementById('utilizationAnalytics').textContent = '78%'; // Static for now
            document.getElementById('nextAvailable').textContent = nextAvailable;
            
            // Update patient load summary
            document.getElementById('activePatients').textContent = activePatients;
            document.getElementById('completedToday').textContent = completedToday;
            document.getElementById('scheduledCount').textContent = scheduledCount;
            document.getElementById('waitingCount').textContent = waitingCount;
            document.getElementById('urgentCount').textContent = urgentCount;
            document.getElementById('avgWaitDaysSummary').textContent = avgWaitDays;
            
            // Update insights based on current data
            updateScheduleInsights();
        }

        // Update schedule insights based on current data
        function updateScheduleInsights() {
            const avgWaitDays = calculateAverageWaitDays();
            const urgentCount = appointments.filter(apt => apt.priority === 'urgent').length;
            const todayAppointments = appointments.filter(apt => {
                const aptDate = new Date(apt.scheduledDate);
                return aptDate.toDateString() === new Date().toDateString();
            }).length;
            
            // Update insights dynamically
            const insight1 = document.getElementById('insight1');
            const insight2 = document.getElementById('insight2');
            const insight3 = document.getElementById('insight3');
            const insight4 = document.getElementById('insight4');
            
            if (avgWaitDays <= 7) {
                insight1.innerHTML = `✅ Target achieved: Average wait time is ${avgWaitDays} days (≤7 days)`;
                insight1.style.borderLeftColor = '#28a745';
            } else {
                insight1.innerHTML = `⚠️ Target missed: Average wait time is ${avgWaitDays} days (target: ≤7 days)`;
                insight1.style.borderLeftColor = '#ffc107';
            }
            
            if (urgentCount > 0) {
                insight2.innerHTML = `🚨 ${urgentCount} urgent case(s) requiring immediate attention`;
                insight2.style.borderLeftColor = '#dc3545';
            } else {
                insight2.innerHTML = `✅ No urgent cases pending - good schedule management`;
                insight2.style.borderLeftColor = '#28a745';
            }
            
            insight3.innerHTML = `📈 Peak utilization at 9:00 AM (95%) - consider adding morning slots`;
            insight4.innerHTML = `🕐 Low utilization at 4:00 PM (70%) - opportunity for afternoon optimization`;
        }

        function startRealTimeUpdates() {
            // Update schedule grid every minute for real-time status
            setInterval(() => {
                updateScheduleGrid();
            }, 60000); // Every minute
            
            // Simulate real-time updates every 30 seconds
            setInterval(() => {
                updateDashboard();
                
                // Simulate patient status changes
                appointments.forEach(appointment => {
                    if (appointment.status === 'waiting' && Math.random() > 0.7) {
                        appointment.status = 'in-progress';
                    } else if (appointment.status === 'in-progress' && Math.random() > 0.8) {
                        appointment.status = 'completed';
                    }
                });
                
                updatePatientList();
            }, 30000);
        }

        // Utility functions
        function formatTime(date) {
            return date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
        }

        function formatDate(date) {
            return date.toLocaleDateString();
        }

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'o':
                        e.preventDefault();
                        optimizeSchedule();
                        break;
                    case 'b':
                        e.preventDefault();
                        balanceWorkload();
                        break;
                    case 'r':
                        e.preventDefault();
                        generateReport();
                        break;
                }
            }
        });

        // Debug: Check for Firebase initialization
        console.log('Checking for Firebase...');
        if (typeof firebase !== 'undefined') {
            console.log('Firebase is loaded:', firebase);
        } else {
            console.log('Firebase is not loaded');
        }
        
        // Service worker removed to prevent Firebase initialization errors
    </script>
</body>
</html>
